# Настройка системы валют

## Обновление курсов валют

Курсы валют обновляются автоматически через Edge Function. Для ручного обновления курсов выполните один из следующих вариантов:

### Вариант 1: Через браузер
Откройте URL в браузере:
```
https://[ваш-проект].supabase.co/functions/v1/update-exchange-rates
```

### Вариант 2: Через curl
```bash
curl https://[ваш-проект].supabase.co/functions/v1/update-exchange-rates
```

### Вариант 3: Настроить автоматическое обновление
Вы можете настроить cron job или scheduled function для автоматического обновления курсов каждый день.

## Как работает система

1. **Хранение цен**: Все цены в базе данных хранятся в AED (дирхамы ОАЭ) как чистые числа без валюты
2. **Курсы валют**: Хранятся в таблице `exchange_rates` с колонками:
   - `currency_from`: базовая валюта (AED)
   - `currency_to`: целевая валюта (TJS, USD)
   - `rate`: курс обмена
   - `updated_at`: время последнего обновления

3. **Отображение**: При выборе валюты цены автоматически конвертируются по актуальному курсу

## Поддерживаемые валюты

- **AED** - дирхам ОАЭ (базовая валюта, курс = 1.00)
- **TJS** - таджикский сомони (Tajikistani Somoni, ~2.89 TJS за 1 AED)
- **USD** - доллар США (~0.2723 USD за 1 AED)

**Текущие курсы (согласно Google, ноябрь 2025):**
- 1 AED = 2.89 TJS
- 1 AED = 0.2723 USD

Курсы обновляются ежедневно автоматически через Edge Function, которая получает данные с публичного API курсов валют.

## Импорт Excel файлов

При импорте Excel файлов с более 6000 запчастей:

**Поддерживаемые колонки:**
- **Item Code** или **Part No** → код запчасти
- **Name** или **Part Name** → название запчасти
- **Quantity On Hand** или **Qty** → количество
- **Price** → цена (в AED)

**Важно:**
- Система автоматически очистит цены от символов валюты и сохранит только числа
- При загрузке нового Excel файла ВСЕ старые данные удаляются и заменяются новыми
- Файлы обрабатываются батчами по **10,000 записей** для быстрой загрузки больших файлов
- После загрузки все данные сохраняются в базу данных Supabase
